$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "http://purl.org/iscc/schema/iscc-search-result.json"
title: "IsccSearchResult"
type: object
description: |
  Search result for a single query asset. Contains the original query, matched ISCCs,
  and metric metadata that describes how to interpret the numeric scores.
required:
  - query
  - metric
  - matches
properties:
  query:
    $ref: "./IsccAsset.yaml"
    description: The original query asset (may include auto-generated iscc_id)
  metric:
    type: string
    description: |
      Defines the semantics of score values in matches. Different search backends
      use different metrics (bitlength for lookup, NPHD distance for usearch, etc.).
    enum:
      - nphd
      - hamming
      - bitlength
    example: "nphd"
  matches:
    type: array
    description: List of matched ISCC-IDs with scores, ordered by relevance (best first)
    items:
      $ref: "./IsccMatch.yaml"
    example:
      - iscc_id: "ISCC:MAIGIIFJRDGEQQAA"
        score: 448
        matches:
          CONTENT_TEXT_V0: 256
          DATA_NONE_V0: 128
          INSTANCE_NONE_V0: 64
      - iscc_id: "ISCC:MAIGXXFZRDGEQQBB"
        score: 384
        matches:
          CONTENT_TEXT_V0: 256
          DATA_NONE_V0: 128
example:
  query:
    iscc_id: "ISCC:MAIGXXFZRDGEQQCC"
    iscc_code: "ISCC:KECYCMZIOY36XXGZ7S6QJQ2AEEXPOVEHZYPK6GMSFLU3WF54UPZMTPY"
    units:
      - "ISCC:AADYCMZIOY36XXGZ5B5BME7EIPPXRFKYQZ7VXKI7V55AEQQE67A33BY"
      - "ISCC:EED7ZPIEYNACCLXXZSS2LIM6JVXDYGCG2QSMC7DCPER4MYJPJATIM4Y"
  metric: "bitlength"
  matches:
    - iscc_id: "ISCC:MAIGIIFJRDGEQQAA"
      score: 448
      matches:
        CONTENT_TEXT_V0: 256
        DATA_NONE_V0: 128
        INSTANCE_NONE_V0: 64
    - iscc_id: "ISCC:MAIGXXFZRDGEQQBB"
      score: 384
      matches:
        CONTENT_TEXT_V0: 256
        DATA_NONE_V0: 128
